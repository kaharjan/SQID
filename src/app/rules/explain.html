<h1>{{ 'RULES.EXPLANATION' | translate }}</h1>
<div ng-controller="ExplainController">
  <sqid-statement-table ng-if="explanation.statement"
                        data="explanation.statement"
                        title="{{ explanation.title }}">
  </sqid-statement-table>

  <table class="table table-striped table-condensed">
    <tbody>
      <tr>
        <td>{{ 'RULES.RULE' | translate }}</td>
        <td>{{ explanation.rule | formatRule }}</td>
      </tr>
      <tr ng-if="explanation.labels">
        <td>{{ 'RULES.LITERALS' | translate }}</td>
        <td>
          <table class="table table-striped table-condensed">
            <thead>
              <tr>
                <th>{{ 'RULES.LITERAL' | translate }}</th>
                <th>{{ 'RULES.ENTITY' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="(literal, label) in explanation.labels">
                <td>{{ literal }}</td>
                <td ng-bind-html="label"></td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
      <tr ng-if="explanation.bounds">
        <td>{{ 'RULES.BINDINGS' | translate }}</td>
        <td>
          <table class="table table-striped table-condensed">
            <thead>
              <tr>
                <th>{{ 'RULES.BINDING' | translate }}</th>
                <th>{{ 'RULES.ENTITY' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="(variable, binding) in explanation.bounds">
                <td>{{ variable }}</td>
                <td ng-bind-html="binding"></td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
      <tr ng-if="explanation.constraints.length">
        <td>{{ 'RULES.CONSTRAINTS' | translate }}</td>
        <td>
          <table class="table table-striped table-condensed">
            <thead>
              <tr>
                <th>{{ 'RULES.CONSTRAINT_TYPE' | translate }}</th>
                <th colspan="2">{{ 'RULES.CONSTRAINT_ARGUMENTS' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="constraint in explanation.constraints">
                <td>{{ constraint.type }}</td>
                <td>{{ constraint.args[0] }}</td>
                <td>{{ constraint.args[1] }}</td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
      <tr>
        <td>{{ 'RULES.QUERY' | translate }}</td>
        <td>{{ explanation.query }}</td>
      </tr>
    </tbody>
  </table>
</div>
